
## 环境要求

* Python 3.8+
* numpy
---

## 文件说明

### 1. `test_msis.py`

测试 温度、密度、大气组分 封装接口的功能。

* 验证方法：

  * `calc()`：单点计算；
  * `calc_many()`：批量计算（支持列表或 NumPy 向量）。
* 示例输出包括温度、气体组分密度等。

示例代码片段：

```python
from model.pymsis2 import NRLMSIS2, doy, seconds_of_day

msis = NRLMSIS2(precision="single")
res = msis.calc(
    day=doy(2020, 7, 18),
    utsec=seconds_of_day(12, 0, 0.0),
    alt_km=250.0, lat_deg=39.9, lon_deg=116.4,
    f107a=150.0, f107=150.0
)
print(res)
```

输出示例（截取）：

```
alt=250.0 km, T_local=1012 K, rho_O=1.2e-12 kg/m3 ...
```

---

### 2. `test_hwm.py`

测试风场模型封装的功能。

主要检查：

1. `hwm14_eval()`：单点计算；
2. `hwm14_eval_many()`：广播数组输入；
3. 输出风速是否合理（无 NaN/Inf、幅度在 ±1000 m/s 以内）。

示例代码片段：

```python
import model.pyhwm14 as pyhwm14

wm, wz = pyhwm14.hwm14_eval(
    iyd=2025290, sec=43200.0, alt_km=250.0,
    glat_deg=30.0, glon_deg=114.0,
    stl_hours=12.0, f107a=150.0, f107=150.0, ap2=(0.0, 20.0)
)
print(f"wm={wm:.3f}, wz={wz:.3f}")
```

输出示例：

```
[Single Point] wm=-132.843 m/s, wz=25.672 m/s
[Broadcast] wm shape=(5, 9), wz shape=(5, 9)
✅ All tests passed.
```

---

## 运行方法

在项目根目录执行：

```bash
python test_hwm.py
python test_msis.py
```

若模型和 DLL 安装正确，输出应显示各测试通过。

---

## 结果验证要点

* 所有返回值应为有限实数（`np.isfinite`）。
* HWM14 输出风速应在物理合理范围（通常 |v| < 1000 m/s）。
* NRLMSIS 输出温度和密度应随高度合理变化。
---
